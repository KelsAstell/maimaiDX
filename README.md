# iiDX
## 现在正在运营的 iiDX2023 是盗版插件, 请大家不要使用(KohaD语气)


移植自 xybot 及 [mai-bot](https://github.com/Diving-Fish/mai-bot) 开源项目，基于 [HoshinoBotV2](https://github.com/Ice-Cirno/HoshinoBot) 和 [nonebot2](https://v2.nonebot.dev) 的街机音游 **舞萌DX** 的查询插件

## 别人传一行代码算Contribute, 我又是写别名库合并又是提供转换好的alias都没见到有半句谢谢
分支项目地址：https://github.com/KelsAstell/maimaiDX

## iidx分支特性, 看清楚是iidx分支, 烦死了真的造孽
**噢, 不该骂人的, 我的美好品德都随着原作者消逝了**

**2023-06-16**
1. 删除大量(我)用不到的功能
2. 添加各种抽象功能
   查询玩家/BOT天梯榜时增加彩蛋
   添加B40兼容, 喜欢B40的有福了
   一键在水鱼网站上AP**需要自己抓登录的token**
3. 没有玩过特定歌曲会返回抽象内容
4. 替换所有封面为Xray抽象画
5. 可以在static/config.json里切换别名升级通道了[OFFICIAL/OFFLINE/XRAY]


## 指令

| 命令                                             | 功能                            |
|------------------------------------------------|-------------------------------|
| 帮助iiDX                                     | 查看指令帮助                        |
| <歌曲别名>是什么抽象歌                                     | 查询乐曲别名对应的乐曲                   |
| <歌曲ID/歌曲别称>有什么抽象别称                                 | 查询歌曲别名                        |
| 添加抽象别名 <歌曲ID>-<歌曲别名>                             | [SUPERADMIN]直接添加歌曲别名, 申请个毛线, 说的和能过一样|
| 删除抽象别名 <歌曲ID>-<歌曲别名>                             | [SUPERADMIN]直接删除歌曲别名|
| 更改歌曲名称 <歌曲ID>-<歌曲名>                             | [SUPERADMIN]直接更改歌曲名|
| 开启/关闭抽象猜歌                                     | 开关猜歌功能                        |
| info<@> <id/别称/曲名>                            | 查询单曲成绩                        |
| global[绿黄红紫白] <id/别称/曲名>                        | 查询乐曲游玩总览，不加难度默认为紫谱         |
| ib50/ib40 <游戏名/@someone>                                      | 查询b50, 兼容老的B40指令                         |
| 抽象猜歌/猜歌抽象/曹冲称象                                             | 猜猜猜整天就知道猜, 真的好想骂人               |
| <牌子名称>进度 <名字>                                  | 查看牌子完成进度                      |
| <等级> 分数列表 <名字>                                 | 查看等级评价列表                      |
| 我/你/他/她/祂有多菜 <页数>/<名字>                            | 查看水鱼网站的用户ra排行, 对于BOT来说是抽象内容                 |
| settoken <token>                            | 设定水鱼网站jwt_token, 支持多用户                 |
| settoken <qq=token>                            | [SUPERADMIN]修改水鱼网站jwt_token, eg: 23333333=ajhfadfAFihncauetaUDHOA                |
| 游玩记录                             | 获取自己的游玩记录, 必须是玩过的歌才能一键AP                |
| 一键AP/1keyap <歌曲ID>-<rem/mst/exp/adv/bas>                            | [SUPERADMIN]一键在水鱼网站上AP/FDX, 有概率AP+/FDX+                |

## 更新说明

**2023-06-16**

1. 因原作者**YuzuChaN**在项目中曾使用我提供的别名数据, 而不提供任何说明/致谢感到非常失望.
2. 基于原作者的态度考量, 我没有必要继续在Readme中提供原项目地址或遵循任何原项目指定协议.

**2023-06-09**

1. 更新至 `舞萌DX 2023`
2. 移除指令 `b40`
3. 更换静态资源
4. 修改指令 `b50` 部分绘图

**2023-04-22**

1. 限制所有网络请求时长
2. 新增别名文件本地备份
3. 新增ginfo指令默认使用紫谱数据

**2023-04-21**

1. 新增BOT管理员私聊指令 `全局关闭别名推送` 和 `全局开启别名推送`，关闭所有群的推送消息，无论先前开启还是关闭
2. 修复新版本更新后API暂未收录曲目的问题
3. 新增乐曲游玩总览 `ginfo` 指令
4. 新增猜歌库根据乐曲游玩次数添加
5. 新增每日更新机厅信息，删除旧版更新机厅机制

**2023-04-15**

1. 将获取数据的方式由启动Bot时获取改为连接到CQHTTP后获取
2. 修复因查分器API内容变动而无法启动Bot的问题

**2023-03-29**

1. 重制 `b40/b50` ，`minfo` 和曲目信息的绘图
2. 修改投票网页端，改成共用网站
3. 修改垃圾代码

**2023-03-02**

1. 新增 `开启别名推送` 和 `关闭别名推送` 指令

**2023-02-25**

1. 修复猜歌答对后无法结束的问题

**2023-02-23**

1. 投票网页端

**2023-02-22**

1. 修复启动BOT时无法获取所有曲目信息的问题，添加本地缓存
2. 修改别名库，使用API获取和添加，并同步所有使用该插件的BOT
3. 修改猜歌和别名功能
4. 新增指令 `当前别名投票` 和 `同意别名`

**2023-2-18**

1. 别称同步临时解决方案 #47

**2023-2-15**

1. 更新本地缓存水鱼网数据 #43

**2022-9-14**

1. 新增查询单曲指令 `minfo`
2. 修改查曲绘图

**2022-8-30**

1. 修复新版b40/b50 isinstance bug [#38](https://github.com/Yuri-YuzuChaN/maimaiDX/issues/38)
2. 修复新版b40/b50 找不到图片问题
3. 修复安慰分隐性bug

**2022-08-27**

1. 修复b40/b50小数点后四位错误的问题

**2022-08-25**

1. 修复猜歌模块发送曲绘时为未知曲绘的问题

**2022-08-16**

1. 修改 `b40/b50` 指令绘图，如不喜欢请将 `libraries/maimaidx_project.py` 第`6`行 `maimai_best_50` 改成 `maimai_best_40`
2. 修改查曲绘图

**2022-07-11**

1. 修复指令 `分数列表` 没有提供2022谱面的问题

**2022-06-23**

1. 支持2022
2. 修改所有曲绘后缀
3. 修改获取在线文件的路径

**2022-03-10**

1. 新增段位显示，感谢 [Kurokitu](https://github.com/Kurokitu) 提供源码及资源

**2022-02-13**

1. 修复部分新曲没有难易度参考的问题

**2022-01-27**

1. 修复添加/删除别名无效的问题

**2022-01-16**

1. 修复b40/b50查询@Ta人情况下无效的问题

**2022-01-03**

1. 修改获取音乐数据的函数，不在使用同步进程
2. 不再使用正则表达式获取@人员的QQ号
3. 不再使用CQ码方式发送图片
4. 修改大部分源码

**2021-11-15**

1. 在请求获取maimaiDX数据的函数添加 `@retry` 装饰器，遇到请求数据失败的情况时重新尝试请求

**2021-10-18**

1. 添加排卡功能，感谢 [CrazyKid](https://github.com/CrazyKidCN)

**2021-10-14**

1. 更新查看推荐的上分乐曲
2. 更新查看牌子完成进度
3. 更新查看等级评价完成进度
4. 查看水鱼网站的用户ra排行

**2021-09-29**

1. 更新b50、乐曲推荐功能，感谢 [BlueDeer233](https://github.com/BlueDeer233) 

**2021-09-13** 

1. 更新猜歌功能以及开关，感谢 [BlueDeer233](https://github.com/BlueDeer233) 


## 鸣谢

感谢 [zhanbao2000](https://github.com/zhanbao2000) 提供的 `nonebot2` 分支

感谢 [CrazyKid](https://github.com/CrazyKidCN) 提供的源码支持

感谢 [Diving-Fish](https://github.com/Diving-Fish) 提供的源码支持

感谢 [BlueDeer233](https://github.com/BlueDeer233) 提供猜歌功能的源码支持

## License

？不存在的, 你用我别名库的时候你按照MIT了吗？致谢呢, 脸这么大？
